<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>KAN网络 | 肖慧慧的网站</title><meta name="author" content="-.-"><meta name="copyright" content="-.-"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="AI大讲堂：深度学习要变天？专业拆解【KAN网络】 人话讲论文系列：KAN模型（上）.pdf MLP本质回顾 $f(x)&#x3D;wx+b$ KAN网络为什么牛逼？Kolmogorov-Arnold Networks顾名思义基于柯尔莫果洛夫-阿诺尔德表示定理。是由这两个俄罗斯数学家1957年提出的如何用一组较简单的函数来表示任何一个多变量的连续函数。 $f(\mathbf{x})&#x3D;\">
<meta property="og:type" content="article">
<meta property="og:title" content="KAN网络">
<meta property="og:url" content="http://example.com/2024/07/kan_model.html">
<meta property="og:site_name" content="肖慧慧的网站">
<meta property="og:description" content="AI大讲堂：深度学习要变天？专业拆解【KAN网络】 人话讲论文系列：KAN模型（上）.pdf MLP本质回顾 $f(x)&#x3D;wx+b$ KAN网络为什么牛逼？Kolmogorov-Arnold Networks顾名思义基于柯尔莫果洛夫-阿诺尔德表示定理。是由这两个俄罗斯数学家1957年提出的如何用一组较简单的函数来表示任何一个多变量的连续函数。 $f(\mathbf{x})&#x3D;\">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2024-07-05T08:58:55.472Z">
<meta property="article:modified_time" content="2024-07-05T08:59:37.609Z">
<meta property="article:author" content="-.-">
<meta property="article:tag" content="Transformer">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2024/07/kan_model.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.14.0-b2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>(()=>{
      const saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      
      window.btf = {
        saveToLocal: saveToLocal,
        getScript: (url, attr = {}) => new Promise((resolve, reject) => {
          const script = document.createElement('script')
          script.src = url
          script.async = true
          script.onerror = reject
          script.onload = script.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            script.onload = script.onreadystatechange = null
            resolve()
          }

          Object.keys(attr).forEach(key => {
            script.setAttribute(key, attr[key])
          })

          document.head.appendChild(script)
        }),

        getCSS: (url, id = false) => new Promise((resolve, reject) => {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = url
          if (id) link.id = id
          link.onerror = reject
          link.onload = link.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            link.onload = link.onreadystatechange = null
            resolve()
          }
          document.head.appendChild(link)
        }),

        addGlobalFn: (key, fn, name = false, parent = window) => {
          const pjaxEnable = false
          if (!pjaxEnable && key.startsWith('pjax')) return

          const globalFn = parent.globalFn || {}
          const keyObj = globalFn[key] || {}
    
          if (name && keyObj[name]) return
    
          name = name || Object.keys(keyObj).length
          keyObj[name] = fn
          globalFn[key] = keyObj
          parent.globalFn = globalFn
        }
      }
    
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode
      
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })()</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'KAN网络',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-05 16:59:37'
}</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="肖慧慧的网站"></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">KAN网络</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-07-05T08:58:55.472Z" title="发表于 2024-07-05 16:58:55">2024-07-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-05T08:59:37.609Z" title="更新于 2024-07-05 16:59:37">2024-07-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="KAN网络"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><hr>
<h1 id="AI大讲堂：深度学习要变天？专业拆解【KAN网络】"><a href="#AI大讲堂：深度学习要变天？专业拆解【KAN网络】" class="headerlink" title="AI大讲堂：深度学习要变天？专业拆解【KAN网络】"></a>AI大讲堂：深度学习要变天？专业拆解【KAN网络】</h1><p><img src="https://s2.loli.net/2024/06/20/Nz5EFfrxpJPMbgy.png" alt="image-20240620161210708"></p>
<p>人话讲论文系列：KAN模型（上）.pdf</p>
<p>MLP本质回顾</p>
<p>$f(x)&#x3D;wx+b$</p>
<h2 id="KAN网络为什么牛逼？"><a href="#KAN网络为什么牛逼？" class="headerlink" title="KAN网络为什么牛逼？"></a>KAN网络为什么牛逼？</h2><p>Kolmogorov-Arnold Networks顾名思义基于柯尔莫果洛夫-阿诺尔德表示定理。是由这两个俄罗斯数学家1957年提出的如何用一组较简单的函数来表示任何一个多变量的连续函数。</p>
<p>$f(\mathbf{x})&#x3D;\sum_{q&#x3D;1}^{2n+1}\Phi_q\left(\sum_{p&#x3D;1}^n\phi_{q,p}(x_p)\right)$</p>
<p>想象一下，你有一个非常复杂的配方，需要各种各样的原料和步骤来制作一道菜。柯尔莫果洛夫阿诺尔德表示定理告诉我们，无论这个配方多么复杂，我们总能找到一种方法，通过一些简单的基本步骤（这里是一些基本的函数）来重现这道菜的味道。</p>
<p>在上面的式子中，输入是×，$\phi q$,$p(xp)$是基本的一元函数，就像是青椒西红柿基本原料的处理。内层求和就是放到一起。$\phi q$是外层的函数，各自接受内层求和的结果作为输入。外层的求和∑表示整个函数灯是子函数中q的和。用图来表示就相当于一个两层的神经网络，区别在于一没了线性组合，而是直接对输入进行激活：二来这些激活函数不是固定的，而是可以学习的。</p>
<p><img src="https://s2.loli.net/2024/06/20/nJIUH6pt3bCAkDZ.png" alt="image-20240620163842529"></p>
<ol>
<li>learnable activation functions on deges</li>
<li>sum opearation on nodes</li>
</ol>
<p>和MLP每层统一进行非线性空间变换相比，这相当于对每个坐标轴单独进行非线性变换，然后再组合形成多维度空间。（画个简图，先组合再变形和先单个变形再简单组<br>合的区别）</p>
<p>公式写成向量的形式就是</p>
<p>$\mathrm{KAN}(\mathbf{x})&#x3D;(\mathbf{\Phi}<em>{3}\circ\mathbf{\Phi}</em>{2}\circ\mathbf{\Phi}_{1})(\mathbf{x})$</p>
<p>$\mathrm{MLP}(\mathbf{x})&#x3D;(\mathbf{W}<em>{3}\circ\sigma</em>{2}\circ\mathbf{W}<em>{2}\circ\sigma</em>{1}\circ\mathbf{W}_{1})(\mathbf{x})$</p>
<p>对比MLP，没有了激活函数和参数矩阵的嵌套关系，而直接是非线性函数φ的嵌套。<br>对于多层网络，这相当于下面的结构：</p>
<p><img src="https://s2.loli.net/2024/06/20/M15Itl2zyxoS3ua.png" alt="image-20240620164411364"></p>
<p>注意这里所有的非线性函数Φ都采用同样的函数结构，只是用不同的参数来控制其形状。具体<br>来说，文章选择了数值分析中的样条函数<code>spline</code>。这个英语单词spline来源于可变形的样条<br>工具，那是一种在造船和工程制图时用来画出光滑形状的工具。</p>
<p><img src="https://s2.loli.net/2024/06/20/s5JUluEXC48aP1e.png" alt="image-20240620164659721"></p>
<p>样条函数的研究始于20世纪中叶，到了60年代它与计算机铺助设计相结合，在外形设计方面得到成功的应用。样条理论已成为函数逼近的有力工具。</p>
<p>对比MLP和KAN,最大的区别就是变固定的非线性激活+线性参数学习为直接对参数化的非线性激活函数的学习。因为参数本身的复杂度，显然单个spie函数的学习难度要比线性函数难，但KANs通常允许比MLPs更小的计算图，也就是实现同样效果，需要的网络规模更小。例如，文章展示了在解偏微分方程(PDE)的过程中，一个2层宽度为10的KAN比一个4层宽度为100的MLP具有更高的准确度（均方误差10^-7对比10^-5)并且具有更高的参数效率(参数数量100对比10000)。</p>
<p>到这里为止，你一定好奇，这DEA不复杂啊，难道以前没人想到，有，但是卡壳在都坚持使用原始的二层宽度为(2+1)的表示方法，并没有机会利用更现代的技术（例如，反向传播）来训川练网络。KAN模型的贡献就在于通过进一步简化推广到任意宽度和深度，同时通过广泛的实证实验论证了在A!+科学方面的效果，而且具备很好的准确性和可解释性。这就牛逼了啊，深度学习最大的问题就是个黑盒子，训练网络像是炼丹。大模型越弄越大，很可能一条道走到黑就进死胡同了。好比芯片的摩尔定律。现在出现了量子芯片，原理上就不同，从而有可能实现根本性的变革。当然，原来的各种网络结构还能平替重做一遍，有没有感觉一片Al新大陆向你招手了。我一直劝大家别太短视，成天只盯着transformer,大模型兜兜转转，撑死了也是井中之蛙。</p>
<p>好，咱们接着走进技术细节，来把KAN网络扒光。</p>
<p><img src="https://s2.loli.net/2024/06/20/7vwgAEYTnoNkxsK.png" alt="image-20240620165132329"></p>
<p>整篇文章用了这样一张图来装逼，大部分都是废话，关键词就是仁：<code>数学上有据可依</code>，用实<br>验分别证明了<code>准确性</code>和<code>可解释性</code>。</p>
<h2 id="四、KAN的架构细节"><a href="#四、KAN的架构细节" class="headerlink" title="四、KAN的架构细节"></a>四、KAN的架构细节</h2><h2 id="4-1详细解释"><a href="#4-1详细解释" class="headerlink" title="4.1详细解释"></a>4.1详细解释</h2><p>整个网络架构原理看图一目了然。很多个这种类以四分之三个周期的正弦函数组合起来就能拟<br>合任意形状的函数。换句话说，用B-spline这一种激活函数两次求和就够了。</p>
<p><img src="https://s2.loli.net/2024/06/20/hTgqElxaGNvCJAS.png" alt="image-20240620165816809"></p>
<p>图中展示的结构中，使用了两种尺度或分辩率的组合：粗粒度和细粒度网格，在保持<br>计算效率的同时，更加精确地捕捉和适应函数的变化。这种基础结构其实并不是很难<br>想到，以前就有了，但难点是怎么把它变深，否则单靠这么点玩意儿是不能逼近复杂<br>函数的。这就是本文的主要贡献了。</p>
<p>要构建深层KAN,首先需要回答：“什么是KAN层？”简单说，它就是一个一维函数矩<br>阵。</p>
<p>$\Phi&#x3D;{\phi_{q,p}},\quad p&#x3D;1,2,\cdots,n_{\mathrm{in}},\quad q&#x3D;1,2\cdots,n_{\mathrm{out}},$</p>
<p>这样以来，前面的两层KAN网络第一层输入有n个，输出为2n+1个，第二层输入为<br>2+1,最终输出为1个。想更深就简单堆叠好了，和MLP一个球样。简单说就是找<br>层输入输出之间的转移矩阵</p>
<p>$\mathbf{x}<em>{l+1}&#x3D;\underbrace{\begin{pmatrix}\phi</em>{l,1,1}(\cdot)&amp;\phi_{l,1,2}(\cdot)&amp;\cdots&amp;\phi_{l,1,n_l}(\cdot)\\phi_{l,2,1}(\cdot)&amp;\phi_{l,2,2}(\cdot)&amp;\cdots&amp;\phi_{l,2,n_l}(\cdot)\\vdots&amp;\vdots&amp;&amp;\vdots\\phi_{l,n_{l+1},1}(\cdot)&amp;\phi_{l,n_{l+1},2}(\cdot)&amp;\cdots&amp;\phi_{l,n_{l+1},n_l}(\cdot)\end{pmatrix}}_{\Phi_l}\mathbf{x}_l,$</p>
<p>这里<code>l</code>是层编号，右边为输入，左边为输出。看上面左图就大致明白对应关系，输入为2个，因此第二层是2×2+1&#x3D;5个。，订就是每条边上的激活函数，也就是非线性变<br>换。相当于每个×都有5个分身，然后再分别组合。其中i用来标记当前层的节点，而j用来标记下一层的节点。每个节点x_,i的输出通过激活函数中_，，j处理后，贡献到所有下一层的x+1,的计算中。对应上面左图，输入层2个节点，第二层5个节点，因此矩阵为5*2。矩阵的第一列表示×0,1对应的5个激活函数，第二列对应X0,2的，然后两两组合。</p>
<p>因此，这里需要强调的是KAN网络层节点数不是随便搞的，由输入节点个数确定2n+1个，然后所需要的参数或者连接数为(2n+1)*n,明显比全连接少了不少，看图就知道。</p>
<p>进而把多层函数级联关系写成矩阵形式就是:</p>
<p>$\mathrm{KAN}(\mathbf{x})&#x3D;(\boldsymbol{\Phi}<em>{L-1}\circ\boldsymbol{\Phi}</em>{L-2}\circ\cdots\circ\boldsymbol{\Phi}_1\circ\boldsymbol{\Phi}_0)\mathbf{x}.\quad(2.7)$</p>
<p>或者展开的形式</p>
<p>$f(\mathbf{x})&#x3D;\sum_{i_{L-1}&#x3D;1}^{n_{L-1}}\phi_{L-1,i_{L},i_{L-1}}\left(\sum_{i_{L-2}&#x3D;1}^{n_{L-2}}\cdots\left(\sum_{i_{2}&#x3D;1}^{n_{2}}\phi_{2,i_{3},i_{2}}\left(\sum_{i_{1}&#x3D;1}^{n_{1}}\phi_{1,i_{2},i_{1}}\left(\sum_{i_{0}&#x3D;1}^{n_{0}}\phi_{0,i_{1},i_{0}}(x_{i_{0}})\right)\right)\right)\cdots\right),$</p>
<p>再小结一下，原始的两层KAN网络的形状是<code>[n,2n+1,1]</code>,现在变成了<code>多层级联</code>。这里貌似进一步又放开了2+1的结构限制，甚至隐层节点数可以自由发挥。</p>
<p><img src="https://s2.loli.net/2024/06/20/qiENmtzk954Mr76.png" alt="image-20240620170705266"></p>
<p>比如这个图中显然隐层个数不是2+1，但依然是各自对应位置的求和，而不是全连<br>接。<br><code>执行细节</code><br>1.<code>残差激活函数</code>：我们包含了一个基础函数b(x)（类似于残差连接中的函数），使<br>得激活函数(x)是基础函数b(x)和样条函数的总和：</p>
<p>$\phi(x)&#x3D;w(b(x)+\mathrm{spline}(x)).$</p>
<p>我们通常设置</p>
<p>$b(x)&#x3D;\text{silu}(x)&#x3D;\frac x{1+e^{-x}}$</p>
<p>样条函数通常参数化为B样条的线性组合：</p>
<p>$\mathrm{spline}(x)&#x3D;\sum_ic_iB_i(x)$</p>
<p>其中c:是可训练的。原则上w是多余的，因为它可以被吸收进b(x)和spline(c).<br>然而，我们仍然包括这个w因子以更好地控制激活函数的整体大小。</p>
<p>SiLU(Sigmoid Linear Unit)是一种神经网络激活函数，也被称为Swish函数。这个函数由一篇Google Brain的论文首次提出，并因其在某些任务上表现出的优异性能而受到关注。你可以认为它就是sigmoid函数的一种变体。</p>
<p>2.假设层宽相等，L层，每层N个节点。<br>2.每个样条函数的阶数通常为k&#x3D;3,在G个区间上G+1个网格点。“G个区间”指的是样条函数的分段定义的区间数。</p>
<p>那么总共大约有O(N2L(G+k)或O(N2LG)个参数。相比之下，具有深度L和宽度N的多层感知机(MLP)只需要O(N2L)个参数，这看起来比KAN更有效率。</p>
<p>也就是说单看计算复杂度好像KAN还不如MLP简单，但是幸运的是，KANs通常需要<br>比MLPs小得多的NN,这不仅节省了参数，而且还提高了泛化能力，并且有助于解<br>释性。<br>换句话理解，就是借助spline样条函数的表达能力，无需很多节点就能实现比较强的<br>表达能力，因此总的来说，可以比MLP节省不少参数量。</p>
<h2 id="4-2逼近能力和缩放定律的讨论"><a href="#4-2逼近能力和缩放定律的讨论" class="headerlink" title="4.2逼近能力和缩放定律的讨论"></a>4.2逼近能力和缩放定律的讨论</h2><p>文章花了一页的篇幅推导证明了定理</p>
<p>$\begin{aligned}&amp;\textbf{Theorem 2.1 (Approximation theory, KAT). Let x}&#x3D;(x_{1},x_{2},\cdots,x_{n}).\textit{Suppose that a function}\&amp;f(\mathbf{x})admitsarepresentation\end{aligned}$</p>
<p>$f&#x3D;(\Phi_{L-1}\circ\Phi_{L-2}\circ\cdots\circ\Phi_{1}\circ\Phi_{0})\mathbf{x},\quad(2.14)$</p>
<p>as in Eq.(2.7),where each one of the ii are (k+1)-times continuously differentiable.Then<br>there exists a constant C depending on f and its representation,such that we have the following<br>approximation bound in terms of the grid size G:there exist k-th order B-spline functions<br>such that for any0≤m≤k,we have the bound</p>
<p>$|f-(\Phi_{L-1}^G\circ\Phi_{L-2}^G\circ\cdots\circ\Phi_1^G\circ\Phi_0^G)\mathbf{x}|_{C^m}\leq CG^{-k-1+m}.\quad(2.15)$</p>
<p>这部分讲的不是人能听懂的话，看不懂很正常。简单说，就是从数学上证明可以通过构建多层的B样条函数网络来有效逼近复杂函数。尽管增加网络的深度和复杂度，KANs能够通过细致的网格划分来逼近高维函数，而不会受到维数灾难的影响，也就是在高维空间中，数据的稀疏性和处理复杂度急剧增加的问题。而残差率不依赖于维度，因此战胜了维数灾难！</p>
<p>再来看看所谓的缩放定律。注意这里的缩放定律与大模型领域的不同。后者是说模型<br>大小（如参数数量）的增加，模型的性能（例如在语言任务中的准确性）通常会提<br>高，并且有时这种提升的速度可以用某些数学关系（如幂律关系）来描述C&#x3D;6ND。这<br>里更偏重于理论和数学上的分析，当然背景相似，都是讨论随着参数数量的增加，模<br>型表现的提升。这部分内容基本上也可以暂时略过，主要就是简要对比了几种理论，<br>关注于如何通过理论来指导实际的神经网络设计，以实现更有效的学习和泛化能力。<br>后面还有讨论，这里暂时可以忽略。<br>好，我们接下来重点看看KAN准确性和可解释性的改进。</p>
<h2 id="4-3如何提升准确性？"><a href="#4-3如何提升准确性？" class="headerlink" title="4.3如何提升准确性？"></a>4.3如何提升准确性？</h2><p><code>MLPs</code>通过增加模型的宽度和深度可以提高性能，但这种方法效率低下，因为需要独立地训练不同大小的模型。</p>
<p><code>KANs</code>:开始可以用较少的参数训川练，然后通过简单地细化其<br>样条网格来增加参数，无需重新训练整个模型。<br>基本原理就是通过将样条函数(splines)I旧的粗网格转换为更细的网格，并对应地调<br>整参数，无需从头开始训练就能扩展现有的KAN模型。这种技术称为“网格扩展”<br>(grid extension)</p>
<p>$\text{Fitting }f(x,y)&#x3D;\exp(\sin(\pi x)+y^2)$</p>
<p><img src="https://s2.loli.net/2024/06/20/RorngTDAOxVIh8d.png" alt="image-20240620172527644"></p>
<p>文章用了一个小例子来证明这一点。用KAN网络逼近一个函数。上图中横轴的每个”gid-x”标签代表了在特定训练步骤时进行网格细化的时点。每次这样的标记出现，都意味着网格点数量在这个步骤有所增加，从而使模型能够更细致地逼近目标函数，这通常会导致误差的下降。表明网格点的增加直接影响了模型的学习效果，提高了逼近目标函数的精度。左右图表示了两种不同结构的网络。</p>
<p>下面两个图分别展示了测试误差随网格大小变化（左下图）和训练时间随网格大小的变化（右下图）。结论就是误差loss随网格大小grid size G在不同的规模上显示出不同的缩放关系；训练时间随网格大小增加而增长，特别是在网格非常大时（接近1000),训练时间急剧上升。<br>这些观测结果支持了文章中关于KANs利用网格扩展可以有效提高精度而无需重新训练整个模型的说法，同时也提示了在选择网格大小时可能需要在模型精度和训练效<br>率之间做出权衡。简单说，网格太密了也不好，太费时。</p>
<h2 id="4-4如何提升可解释性？"><a href="#4-4如何提升可解释性？" class="headerlink" title="4.4如何提升可解释性？"></a>4.4如何提升可解释性？</h2><p>尽管上面介绍了KN的不少好处，但遇到实际问题时该怎么设计网络结构依然是个玄学。因此需要有种方法能自动发现这种结构。本文提出的方法是使用稀疏正则化和剪枝技术从较大的KAN开始训练，剪枝后的KAN比未剪枝的KAN更易解释。为了使KAN达到最大的可解释性，本文提出了几种简化技术，并提供了一个示例，说明用户如何与KAN进行交互以增强可解释性。</p>
<p><img src="https://s2.loli.net/2024/06/20/KkWZLdjAPtIqSpM.png" alt="Figure 2.4:An example of how to do symbolic regression with KAN."></p>
<p>1.稀疏化：使用数据集训练一个KAN模型，使其能够尽可能地拟合目标函数。MLP通常使用L1正则化来促进权重的稀疏性，L1正则化倾向于推动权重值向零收缩，特别是那些对模型输出影响不大的权重。权重矩阵的“稀疏化“可以降低模型的复杂性，减少模型的存储需求和计算负担，因为只需要处理非零权重；还能提高模型的泛化能力，减少过拟合的风险<br>2.剪枝：在稀疏化后，进一步通过剪枝技术移除那些不重要的连接和神经元。<br>3.设定特定激活函数：根据剪枝后各神经元的特性，手动设置或调整特定神经元的激活函数</p>
<p> 4.训练仿射参数：在调整了激活函数后，对模型中的剩余参数进行再次训练，优化这<br>些参数以最好地拟合数据。<br>5.符号化：最终，模型将输出一个符号公式，这个公式是对原始目标函数的一个近似<br>表示，但通常会更简洁、更易于理解和分析。</p>
<h2 id="五、实验论证"><a href="#五、实验论证" class="headerlink" title="五、实验论证"></a>五、实验论证</h2><p>文章花了很大篇幅汇报详细的模拟实验结果，这也是本文引起轰动的重要原因之一。主要包括<br>准确性和可解释两部分。</p>
<h3 id="5-1KAN的准确性"><a href="#5-1KAN的准确性" class="headerlink" title="5.1KAN的准确性"></a>5.1KAN的准确性</h3><p><img src="https://s2.loli.net/2024/06/20/sSwV2BfGxU6EdpJ.png" alt="image-20240620173526320"></p>
<p>比较了KAN与MLP在逼近5个典型函数上的性能，横轴是参数量，纵轴为均方根误差(RMSE)。总的来说，KAN和MLP随着参数数量的增加，RMSE都在下降。</p>
<p>在大多数情况下，KAN（蓝色线）比相同深度的MLP具有更低的RMSE,尤其是在参数数量较少时。这表明KANs在参数利用效率上可能更高。MLP在参数数量增加后，<br>性能提升逐渐放缓并迅速达到平台期，这可能是因为MLP对于这些类型的函数拟合存在固有的限制。KAN在多个测试案例中都接近或跟随理论曲线。</p>
<p>这表明KANs在处理复杂函数和高维数据时可能是更优的选择，具有更好的扩展性和效率。这种性能优势特别重要，当我们需要从有限的数据中学习复杂的模式时，如在<br>物理建模、声音处理或图像处理等任务中。当然目前还都是比较理论化的实验数据。</p>
<p>接着对比了KAN和MLP在高难度的特殊函数拟合任务上的性能，结论类似。随参数量增多KAN（蓝色）表现稳定，越来越好，而MLP（黄色）出现平台期。KANs在维持低误差的同时，表现出更好的参数效率和泛化能力。这一点对于设计高效且精确的机器学习模型来说是极其重要的，特别是在资源受限或对精度要求极高的应用中。</p>
<p><img src="https://s2.loli.net/2024/06/20/dFPt1Vrz29T4s3G.png" alt="image-20240620173830055"></p>
<p>这些函数涉及椭圆积分和贝塞尔函数的特殊数学函数。</p>
<p>然后又提供了在解决偏微分方程上的例子。对比MLP,KANs在相同参数数量下实现<br>了更低的误差</p>
<p><img src="https://s2.loli.net/2024/06/20/ux8ymLRZTwblgP3.png" alt="image-20240620173956201"></p>
<p>接着，讨论了连续学习问题，顶行展示了用于回归任务的一维数据，包含五个高斯峰数据按阶段顺序呈现，每个阶段只展示一部分数据峰。中间和底部的行分别展示了KAN和MLP在五个学习阶段的拟合结果。KANs能够在新增数据的学习中保持之前学到的知识，而MLP表现出严重的<code>灾难性遗忘</code>，即新学的信息<code>严重干扰了旧知识的记忆</code>。</p>
<p><img src="https://s2.loli.net/2024/06/20/pqwW3xzu5thG6oN.png" alt="image-20240620174047112"></p>
<p>这种能力在机器学习中显然很重要。</p>
<h2 id="5-2KAN的可解释性"><a href="#5-2KAN的可解释性" class="headerlink" title="5.2KAN的可解释性"></a>5.2KAN的可解释性</h2><h3 id="5-2-1蓝督学习的例子"><a href="#5-2-1蓝督学习的例子" class="headerlink" title="5.2.1蓝督学习的例子"></a>5.2.1蓝督学习的例子</h3><p>借助前面提升模型可解释性的小技巧，包括稀疏化、剪枝等，KAN网络最终形成的网络结构<br>不仅能够实现数学函数的拟合，而且其形式本身能反映出被拟合函数的内在结构。</p>
<p><img src="https://s2.loli.net/2024/06/20/9lJRSaifOWwEPCH.png" alt="Figure 4.1:KANs are interepretable for simple symbolic tasks"></p>
<p>以第一个图为例<br>函数：f(c,y)&#x3D;xy<br>解释：<br>图中的结构利用了恒等式$2xy&#x3D;(x+y)^2-x^2-y^2$来计算乘法。这说明<br>KAN通过结合基本运算(加法、平方)来实现复杂的乘法操作，展示了KAN如何通<br>过基本的数学操作构造更复杂的函数。<br>X和y各自经过线性函数求和，然后平方，同时再减去X和y的平方。</p>
<p>因此可以看出，KAN模型的牛逼之处在于两点：首先，不仅仅在于自身的模型结构，MLP是<br>先组合再非线性激活，KAN是先非线性激活再组合：其次，KAN的训川练能实现自身结构上的<br>优化，有点自组织的味道了。</p>
<h4 id="5-2-2非监督学习的例子"><a href="#5-2-2非监督学习的例子" class="headerlink" title="5.2.2非监督学习的例子"></a>5.2.2非监督学习的例子</h4><p>上面是个监督学习的例子，用来逼近合成数据。再来看一个非监督学习的例子。</p>
<p><img src="https://s2.loli.net/2024/06/20/J6XR4tsPvdw2DOH.png" alt="Figure 4.2:Unsupervised learning of a toy task.KANs can identify groups of dependent variables,i.e..
(1,2,3)and (4,6)in this case."></p>
<p>在无监督学习中，目标是识别数据中变量之间的依赖关系，而不是预测输出。KANs通过修改其结构，能够识别哪些输入变量是相互依赖的。左图(seed-0)和右图(seed&#x3D;2024)显示了相同的数据集但不同的初始化种子如何导致KAN学到不同的依赖关系结构。<br>KAN通过其灵活的网络结构提供了一种强大的工具来探索这些关系，从而增强了摸型的解释性和应用的广泛性。</p>
<h4 id="5-2-3数学领域的应用示例"><a href="#5-2-3数学领域的应用示例" class="headerlink" title="5.2.3数学领域的应用示例"></a>5.2.3数学领域的应用示例</h4><p>用KAN来处理结点理论问题。结点理论(Knot Theory)是拓扑学的一个分支，专门研<br>究数学中的结。</p>
<p>图ā显示使用17个变量的网络结构实现了81.6%的测试准确率。仅使用3个最重要的变量精简后的模型达到了78.2%的测试准确率。图(c)通过饼图展示了三个变量对预测结<br>果的贡献比例。</p>
<p><img src="https://s2.loli.net/2024/06/20/j6JQtLf9F4AklCD.png" alt="Figure 4.3:Knot dataset,supervised mode.With KANs,we rediscover Deepmind&#39;s results that signature is
mainly dependent on meridinal translation(real and imaginary parts)."></p>
<p>通过优化输入变量的选择，KAN能够在保持较高准确性的同时，显著减少模型复杂<br>度。这一点对于希望减少计算资源消耗同时提高模型解释性的应用场景尤为重要。<br>也就是说，KAN的训练算法能够某种程度上实现网络结构的自我选择和优化。<br>如果说上面的例子还是监督学习，只能用于验证，那么利用无监督学习KAN还能用来发现新的数据结构，这就是是下面的例子。</p>
<p><img src="https://s2.loli.net/2024/06/20/UjNoA9zTrCl7Oyk.png" alt="Figure 4.4:Knot dataset,unsupervised mode.With KANs,we rediscover three mathematical relations in the
knot dataset."></p>
<p>图a重新发现签名依赖性；图(b)展示了KAN如何在不需要任何先验知识的情况下，通过自学习过程重新发现尖点体积定义。图c)中数据点围绕着直线y&#x3D;x&#x2F;2分布，表明y和x之间存在直接的线性关系。y始终小于或等于x的一半，相当于重新发现一个不等式。这种自发现的能力说明了KAN可以作为一种探索数据中隐藏模式的强大工具。</p>
<h4 id="5-2-4物理领域的应用示例"><a href="#5-2-4物理领域的应用示例" class="headerlink" title="5.2.4物理领域的应用示例"></a>5.2.4物理领域的应用示例</h4><p>接着，本文继续用KAN来探索和解释物理模型中的动力学边界，尤其是在量子系统的安德森局域化现象中的应用。</p>
<p><img src="https://s2.loli.net/2024/06/20/elUFm2J63df8iLt.png" alt="Figure 4.5:Results for the Mosaic Model.Top:phase diagram.Middle and Bottom:KANs can obtain both
qualitative intuition (bottom)and extract quantitative results(middle).5is the golden ratio."></p>
<p>这个图展示了把KAN应用于两个具体的物理模型。<br>顶部：显示了模型的相图，描绘了系统参数变化下的物理状态，具体是啥咱也不用懂。<br>中部：展示了系统的特征尺寸随系统参数变化的行为，这有助于量化电子状态的局部化程度。具体是啥也不用懂。<br>底部：提供了对应的KAN结构，展示了网络如何通过学习输入数据（系统参数）来输出对应的物理行为（如局部化状态），并突出了关键的网络节点和连接，这有助于<br>理解模型中最重要的物理量。反正就是说结构能有助于理解。<br>那既然KAN训练本身能自动选择结构，而结构又能有一定物理意义。那这种结构优化能人为控制吗？于是文章又举了一个这样的例子：自动和手动模式的比较。</p>
<p><img src="https://s2.loli.net/2024/06/20/jXifSbVEyF2to7c.png" alt="Figure 4.6:Human-KAN collaboration to discover mobility edges of GAAM and MAAM.The human user can
choose to be lazy (using the auto mode)or more involved (using the manual mode).More details in text."></p>
<p>自动模式下，KANs完全基于数据自动构建和优化网络结构，无需人工干预。这可以<br>快速得到一个工作模型，但可能缺乏针对复杂问题的深入定制。在手动模式下，用户<br>可以更深入地介入模型的构建过程，例如通过手动设置网络层和激活函数来探索数据<br>中的特定特征或关系。这种方法虽然更耗时，但可以更精确地调整模型以适应特定的<br>科学问题。通过结合KANs的自动化能力和用户的专业知识，可以有效地发掘和解释<br>物理系统中的关键现象，尤其是在处理难以用传统方法解析的复杂系统时。</p>
<h2 id="六、MLP和KAN到底该怎么选？"><a href="#六、MLP和KAN到底该怎么选？" class="headerlink" title="六、MLP和KAN到底该怎么选？"></a>六、MLP和KAN到底该怎么选？</h2><p><img src="https://s2.loli.net/2024/06/20/ARo68nEGHqmKXPI.png" alt="Figure 6.1:Should I use KANs or MLPs?"></p>
<p>关于这个问题，主要看想要的是什么？如果效率优先，也就是最右边这条支路，选MLP,因<br>为目前，KANs训练速度较慢是其主要瓶颈，通常比MLPs慢10倍。但如果想要小模<br>型，KAN更好。如果可解释性优先，选中间，那么KAN牛逼。如果准确性优先，最左边，KAN也更牛逼。<br>尽管KAN显示了不错的前景，但毕竟刚开始，还很<code>不足</code>。这包括：<br><code>数学方面</code>，其实对Kolmogorov-Arnold表示定理做了很多简化，而且这个定理本身并没有考虑深层情况，也许增加深度概念后数学基础更强。<br><code>算法方面</code>，还没有充分探索KANs的架构设计和训练方法，以改进模型准确性。比如<br>替换spline激活函数，也许更好。效率方面还有待提升。同时，是不是可以与MLP混合使用也值得考虑。</p>
<p>七、代码实现<br>来到Github上看代码，文件夹包括了论文和代码。后者在kan文件夹。<br><a target="_blank" rel="noopener" href="https://github.com/KindXiaoming/pykan">https://github.com/KindXiaoming/pykan</a></p>
<p>打开代码文件夹，目录结构很简洁。<br>KAN.py是主要的文件，包含了定义KAN模型的主要类或函数，负责模型的建立和训<br>练流程。<br>KANLayer..py定义了KAN模型中使用的自定义层，包括模型的核心组件，如特殊的激<br>活层或其他处理层，这些是构成KAN的基础。<br>L-BFGS.py包含了适用于KANs训练的L-BFGS优化器的实现。<br>Symbolic_.KANLayer..py实现了一种特殊的KAN层，用于处理符号计算或增强模型的解<br>释性。将数据或激活函数转换为符号形式，以便进行更深入的分析或解释。<br>spline.py包含实现样条函数的代码</p>
<p>我们着重看下KAN.py和KANLayer.py两个文件。这个KAN.py文件定义了一个KAN类，继承自torch.nn.Module,主要用于实现一个基于卷积的神经网络模型。</p>
<p><code>属性(Attributes)</code><br>·biases:使用nn.Linear（）’定义的偏置列表。<br>·act_fun:使用KANLayer’定义的激活函数层列表。<br>·depth:网络的深度。<br>·width:每层的神经元数量。<br>grid:网格间隔数。<br>·k:分段多项式的阶数。<br>·base.fun:基函数，用于定义激活函数的基础形式<br>·symbolic..fun:使用Symbolic_.KANLayer定义的符号激活函数层列表。<br>symbolic..enabled:标志位，用于控制是否计算符号前端以节省时间。<br><code>方法(Methods)</code></p>
<p>iitO:初始化KAN模型，可以设定网络宽度、网格数、多项式阶数、噪声比例、基<br>函数等。<br>·forward0:前向传播函数，根据输入数据通过网络计算输出。<br>·train（）:训练模型，包括设定优化器、损失函数、正则化方法等。<br>prue(0:对模型进行剪枝，移除不重要的连接或节点以简化模型和减少计算量。<br>pot0:绘制网络结构图，显示网络各层连接和激活函数的详细信息。<br>symbolic.formula0:提取和返回网络的符号表达式，用于分析网络结构的数学形式。</p>
<p><code>代码逻辑流程</code><br>1.初始化：在类的构造函数中初始化网络结构，包括层的设置、氵<br>激活函数的初始化<br>等。<br>2.前向传播：定义前向传播逻辑，<br>如何通过每一层和每个激活函数计算输出。<br>3.训练过程：<br>设置训练参数，执行训川练循环，包括前向传播、损失计算、反向传播和<br>参数更新。<br>4.剪枝和可视化：提供方法对网络进行剪枝并可视化网络结构，以便分析和优化。<br>5.符号表达式提取：提取网络的数学符号表达式，用于深入理解网络的工作原理。<br>再来看看<code>KANLayer.py</code>文件，</p>
<h2 id="八、小结"><a href="#八、小结" class="headerlink" title="八、小结"></a>八、小结</h2><p>1.<code>MLP的硬伤</code>：我们回归了MLP的核心原理，线性组合+非线性激活。深层次化网络后，反<br>向传播求导数时单一激活函数的连乘积会产生很多问题，而且全连接网络导致参数效率低<br>下。<br>2.<code>KAN的原理</code>：用单一架构的参数化可学习非线性激活函数直接组合，实现非线性空间变<br>换。模型表征能力大大提升。<br>3.<code>KAN训练算法</code>：通过grid extension,也就是激活函数分辩率提升，以及稀疏化、剪枝等<br>结构自优化技巧，实现了准确性和可解释性的提升。能够在参数量大大减少的情况下实现<br>相同甚至更有的拟合效果。<br>4.<code>实验验证</code>：仿真实验提供了有效的量化的效果证明，展示了非常有前景的方向，但目前显<br>然还比较初级。不过，提供了一条新的道路。</p>
<p>俗话说，天下大事，分久必合，合久必分。深度学习的理论也已经十几年一成不变了。这就相当于建筑学上的砖混结构，曾经称霸数十年。当出现钢筋混凝土浇筑结构的时候，整个建造的方法就会发生翻天覆地的变化。KAN网络无疑展示出了能够替换传统的多层感知机结构的强大实力。也让众多的研究者看到了深度学习乃至于整个人工智能新的一大片蓝海。这也是为什<br>么能够让大家像打了鸡血一样兴奋起来的原因。以前不知道idea,现在借助这个结构可以重做一遍。<br>如果今天的分享对你有所帮助，欢迎三连支持。我是梗直哥。学好A!不迷路。只说人话，专治好奇。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">conda create -n kan620 python=<span class="number">3.9</span></span><br><span class="line">conda activate kan620</span><br><span class="line"></span><br><span class="line">conda install pytorch==<span class="number">1.10</span><span class="number">.0</span> torchvision==<span class="number">0.11</span><span class="number">.0</span> torchaudio==<span class="number">0.10</span><span class="number">.0</span> cudatoolkit=<span class="number">11.3</span> -c pytorch -c conda-forge</span><br><span class="line"><span class="comment"># 其他配套安装</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pip install torchtext==<span class="number">0.11</span><span class="number">.0</span></span><br><span class="line">pip install spacy</span><br><span class="line">pip install pyitcast</span><br><span class="line">pip install pandas</span><br><span class="line">pip install matplotlib</span><br><span class="line">pip install AEML</span><br><span class="line">pip install tensorboard</span><br><span class="line">pip install distutils</span><br><span class="line"></span><br><span class="line">pip uninstall setuptools</span><br><span class="line">pip install setuptools==<span class="number">59.5</span><span class="number">.0</span> //需要比你之前的低 </span><br><span class="line">pip install scikit-learn</span><br><span class="line">pip install seaborn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">禁用 conda env remove --name &lt;env_name&gt;</span><br><span class="line">pip install -r H:\PyTorch\4StockMarketPrediction\requirements.txt\requirement.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Transformer/">Transformer</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/english_learn.html" title="英文写作"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">英文写作</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/Transformer5.html" title="Transformer学习笔记五：Subword Tokenization（子词分词器）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Transformer学习笔记五：Subword Tokenization（子词分词器）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/04/Transformer5.html" title="Transformer学习笔记五：Subword Tokenization（子词分词器）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-29</div><div class="title">Transformer学习笔记五：Subword Tokenization（子词分词器）</div></div></a></div><div><a href="/2024/04/Tranformer_chen.html" title="陈硕--Transformer-Attention Is All You Need"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-28</div><div class="title">陈硕--Transformer-Attention Is All You Need</div></div></a></div><div><a href="/2024/04/c3df.html" title="第二章 Transformer"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-28</div><div class="title">第二章 Transformer</div></div></a></div><div><a href="/2024/04/Tranformer3.html" title="Transformer学习笔记三：为什么Transformer要用LayerNorm&#x2F;Batch Normalization &amp; Layer Normalization （批量&amp;层标准化)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-28</div><div class="title">Transformer学习笔记三：为什么Transformer要用LayerNorm&#x2F;Batch Normalization &amp; Layer Normalization （批量&amp;层标准化)</div></div></a></div><div><a href="/2024/04/463e.html" title="1 3 Transformer"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-28</div><div class="title">1 3 Transformer</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">-.-</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">20</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#AI%E5%A4%A7%E8%AE%B2%E5%A0%82%EF%BC%9A%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%A6%81%E5%8F%98%E5%A4%A9%EF%BC%9F%E4%B8%93%E4%B8%9A%E6%8B%86%E8%A7%A3%E3%80%90KAN%E7%BD%91%E7%BB%9C%E3%80%91"><span class="toc-number">1.</span> <span class="toc-text">AI大讲堂：深度学习要变天？专业拆解【KAN网络】</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#KAN%E7%BD%91%E7%BB%9C%E4%B8%BA%E4%BB%80%E4%B9%88%E7%89%9B%E9%80%BC%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">KAN网络为什么牛逼？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81KAN%E7%9A%84%E6%9E%B6%E6%9E%84%E7%BB%86%E8%8A%82"><span class="toc-number">1.2.</span> <span class="toc-text">四、KAN的架构细节</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A"><span class="toc-number">1.3.</span> <span class="toc-text">4.1详细解释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E9%80%BC%E8%BF%91%E8%83%BD%E5%8A%9B%E5%92%8C%E7%BC%A9%E6%94%BE%E5%AE%9A%E5%BE%8B%E7%9A%84%E8%AE%A8%E8%AE%BA"><span class="toc-number">1.4.</span> <span class="toc-text">4.2逼近能力和缩放定律的讨论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3%E5%A6%82%E4%BD%95%E6%8F%90%E5%8D%87%E5%87%86%E7%A1%AE%E6%80%A7%EF%BC%9F"><span class="toc-number">1.5.</span> <span class="toc-text">4.3如何提升准确性？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4%E5%A6%82%E4%BD%95%E6%8F%90%E5%8D%87%E5%8F%AF%E8%A7%A3%E9%87%8A%E6%80%A7%EF%BC%9F"><span class="toc-number">1.6.</span> <span class="toc-text">4.4如何提升可解释性？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%AE%9E%E9%AA%8C%E8%AE%BA%E8%AF%81"><span class="toc-number">1.7.</span> <span class="toc-text">五、实验论证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1KAN%E7%9A%84%E5%87%86%E7%A1%AE%E6%80%A7"><span class="toc-number">1.7.1.</span> <span class="toc-text">5.1KAN的准确性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2KAN%E7%9A%84%E5%8F%AF%E8%A7%A3%E9%87%8A%E6%80%A7"><span class="toc-number">1.8.</span> <span class="toc-text">5.2KAN的可解释性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-1%E8%93%9D%E7%9D%A3%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">1.8.1.</span> <span class="toc-text">5.2.1蓝督学习的例子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2%E9%9D%9E%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">5.2.2非监督学习的例子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-3%E6%95%B0%E5%AD%A6%E9%A2%86%E5%9F%9F%E7%9A%84%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">5.2.3数学领域的应用示例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-4%E7%89%A9%E7%90%86%E9%A2%86%E5%9F%9F%E7%9A%84%E5%BA%94%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.8.1.3.</span> <span class="toc-text">5.2.4物理领域的应用示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81MLP%E5%92%8CKAN%E5%88%B0%E5%BA%95%E8%AF%A5%E6%80%8E%E4%B9%88%E9%80%89%EF%BC%9F"><span class="toc-number">1.9.</span> <span class="toc-text">六、MLP和KAN到底该怎么选？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%B0%8F%E7%BB%93"><span class="toc-number">1.10.</span> <span class="toc-text">八、小结</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/software_must.html" title="必装软件">必装软件</a><time datetime="2025-06-22T01:30:39.127Z" title="发表于 2025-06-22 09:30:39">2025-06-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/Di_wu_juan.html" title="第五卷">第五卷</a><time datetime="2024-11-05T06:09:04.045Z" title="发表于 2024-11-05 14:09:04">2024-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/english_learn.html" title="英文写作">英文写作</a><time datetime="2024-07-30T08:45:39.484Z" title="发表于 2024-07-30 16:45:39">2024-07-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/07/kan_model.html" title="KAN网络">KAN网络</a><time datetime="2024-07-05T08:58:55.472Z" title="发表于 2024-07-05 16:58:55">2024-07-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/04/Transformer5.html" title="Transformer学习笔记五：Subword Tokenization（子词分词器）">Transformer学习笔记五：Subword Tokenization（子词分词器）</a><time datetime="2024-04-29T02:19:08.000Z" title="发表于 2024-04-29 10:19:08">2024-04-29</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By -.-</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.14.0-b2"></script><script src="/js/main.js?v=4.14.0-b2"></script><script src="/js/tw_cn.js?v=4.14.0-b2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'ams'
        },
        chtml: {
          scale: 1.1
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = (ele) => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from(ele).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return
    
    codeMermaidEle.forEach(ele => {
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.innerHTML = `<pre class="mermaid-src" hidden>${ele.textContent}</pre>`
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js').then(runMermaidFn)
  }
  
  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.14.0-b2"></script></div></div></body></html>